# Description: C++ class library of cryptographic schemes.
# URL:         http://www.cryptopp.com/
# Maintainer:  Danny Rawlins, romster at shortcircuit dot net dot au
# Packager:    Han Boetes, han at mijncomputer dot nl
# Depends on:  gcc34

name=libcrypto++
version=5.2.1
release=1
source=(http://www.cryptopp.com/cryptopp${version//./}.zip \
	crypto-$version.patch.gz)

build() {
	zcat crypto-$version.patch.gz |patch
	chmod 755 configure
	CC=gcc-3.4 CXX=g++-3.4 ./configure --prefix=/usr

	# Don't optimize with -O2, it BREAKS the lib: running 'cryptest v' fails
	make CXXFLAGS="-O0 -DNDEBUG -pipe"
	install -d tmp
	cp -a *.dat TestVectors/* tmp

	(
		cd tmp
		../cryptest v
	)

	rm -r tmp
	make DESTDIR=$PKG install
}

