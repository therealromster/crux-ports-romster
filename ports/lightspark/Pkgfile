# Description: High performance flash player designed from scratch to be efficient on modern hardware.
# URL: https://launchpad.net/lightspark
# Maintainer: Danny Rawlins, crux at romster dot me
# Packager: Danny Rawlins, crux at romster dot me
# Depends on: cmake llvm libxml++ pulseaudio ftgl ffmpeg glew curl boost desktop-file-utils hicolor-icon-theme fontconfig xorg-glproto

name=lightspark
version=0.7.2.r5361
sversion=06a72ba9feff21ca4f9915f4c5a88ac0b2e58729
release=1
source=(https://github.com/lightspark/lightspark/archive/$sversion.tar.gz)

build() {
	cd $name-$sversion

	#unset CFLAGS CXXFLAGS LDFLAGS

	# llvm 3.4 compatibility
	sed -i '/JITExceptionHandling/d' src/scripting/abc.cpp

	install -d build
	cd build

	cmake .. \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DMANSUBDIR=man \
		-DCOMPILE_PLUGIN=1 \
		-DCMAKE_BUILD_TYPE=Release \
		-DGNASH_EXE_PATH=/usr/bin/gtk-gnash

	make
	make DESTDIR=$PKG install

	mv $PKG/usr/share/man $PKG/usr/man

	rm -r $PKG/usr/share/locale
}
