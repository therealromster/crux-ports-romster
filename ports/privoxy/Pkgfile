# Description: Web proxy with advanced filtering capabilities.
# URL: http://www.privoxy.org/
# Maintainer: Danny Rawlins, monster dot romster at gmail dot com
# Packager: Mattias Hedenskog, mattias at hedenskog dot se
# Depends on: libpcre

name=privoxy
version=3.0.8
release=1
source=(http://dl.sourceforge.net/sourceforge/ijbswa/privoxy-$version-stable-src.tar.gz \
	privoxy.rc)

build() {
	cd privoxy-$version-stable
	autoheader
	autoconf

	./configure \
		--prefix=/usr \
		--enable-no-gifs

	make

	sed -i -e "s|%%SYSCONFDIR%%|/etc/|" config
	sed -i -e "s|^logdir \.|logdir /var/log/privoxy|" config
	sed -i -e "s|^confdir \.|confdir /etc/privoxy|" config
	
	install -d \
		$PKG/etc/privoxy/templates \
		$PKG/usr/share \
		$PKG/var/log/privoxy

	install -D -m 0755 privoxy $PKG/usr/sbin/privoxy
	install -D -m 0644 privoxy.1 $PKG/usr/man/man1/privoxy.1
	install -D -m 0755 $SRC/privoxy.rc $PKG/etc/rc.d/privoxy
	install -m 0644 -t $PKG/etc/privoxy/ *.action config default.filter
	install -m 0644 -t $PKG/etc/privoxy/templates/ templates/* 
	
}

