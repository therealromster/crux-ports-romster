# Description: Complete solution to record, convert and stream audio and video (snapshot).
# URL: http://ffmpeg.mplayerhq.hu/
# Maintainer: Danny Rawlins, romster at shortcircuit dot net dot au
# Packager: sten, nick dot steeves at shaw dot ca
# Depends on: liba52 faac imlib2 lame libsdl libtheora libxvid x264

name=ffmpeg
version=r10629
release=1
source=(http://romster.shortcircuit.net.au/crux/source/ffmpeg-snapshot-$version.tar.bz2)

build() {
	cd ffmpeg

	unset CFLAGS CXXFLAGS

	sed -i -e 's/^	-$(LDCONFIG)$//' Makefile

	./configure \
		--prefix=/usr \
		--mandir=/usr/man \
		--disable-static \
		--enable-shared \
		--enable-gpl \
		--enable-pp \
		--enable-swscaler \
		--enable-pthreads \
		--enable-x11grab \
		--enable-liba52 \
		--enable-liba52bin \
		--enable-libfaac \
		--enable-libfaad \
		--enable-libfaadbin \
		--enable-libmp3lame \
		--enable-libogg \
		--enable-libtheora \
		--enable-libvorbis \
		--enable-libx264 \
		--enable-libxvid \
		--disable-debug \
		--arch=$(uname -m) \
		--cpu=$(uname -p)
	
	make
	#make -C doc ffmpeg.1 ffserver.1 ffplay.1
	make DESTDIR=$PKG install install-man
}

