# Description: A port of 7-zip for POSIX systems.
# URL: http://p7zip.sourceforge.net/
# Maintainer: Danny Rawlins, romster at shortcircuit dot net dot au
# Packager: Matt Housh, jaeger at crux dot nu
# Dependencies: 

name=p7zip
version=4.58
release=2
source=(http://dl.sourceforge.net/p7zip/p7zip_${version}_src_all.tar.bz2)

build() {
	cd p7zip_$version

	sed -i -e "s/OPTFLAGS=.*/OPTFLAGS=$CFLAGS/" makefile.machine

	make 7zr 7za sfx
	sh install.sh usr/bin usr/lib/p7zip usr/man usr/share/doc/p7zip $PKG/

	rm $PKG/usr/bin/7za \
		$PKG/usr/bin/7zr

	ln -s /usr/lib/p7zip/7za $PKG/usr/bin/7z
	ln -s /usr/lib/p7zip/7za $PKG/usr/bin/7za
	ln -s /usr/lib/p7zip/7zr $PKG/usr/bin/7zr
	rm -r $PKG/usr/share
	chmod -R u+w $PKG
}

