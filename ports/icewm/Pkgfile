# Description: Window manager: speed, simplicity, and not getting in the user's way.
# URL: http://www.icewm.org/
# Maintainer: Danny Rawlins, monster dot romster at gmail dot com
# Packager: Han Boetes, han at mijncomputer dot nl
# Depends on: gdk-pixbuf util-linux xorg-libsm xorg-libxft xorg-libxinerama xorg-libxrandr

name=icewm
version=1.3.7
release=2
source=(http://downloads.sourceforge.net/project/icewm/icewm-${version%.*}/$version/icewm-$version.tar.gz
	icewm-1.3.7-gcc44.patch
	icewm-1.3.7-gcc47.patch
	icewm-1.2.37-libX11-1.5.0-deprecated.patch)

build() {
	cd icewm-$version

	patch -p 1 -i $SRC/icewm-1.3.7-gcc44.patch
	patch -p 1 -i $SRC/icewm-1.3.7-gcc47.patch
	patch -p 1 -i $SRC/icewm-1.2.37-libX11-1.5.0-deprecated.patch

	export LDFLAGS="$LDFLAGS $(pkg-config --libs fontconfig)"

	./configure \
		--prefix=/usr \
		--mandir=/usr/man \
		--disable-nls

	sed -i -e 's|ungif|gif|' src/Makefile

	make
	make DESTDIR=$PKG install
}
