# Description: A centralized git server, with very fine-grained access control and many powerful features.
# URL: https://github.com/sitaramc/gitolite
# Packager:  Danny Rawlins, monster dot romster at gmail dot com
# Maintainer: Danny Rawlins, monster dot romster at gmail dot com
# Depends on: git

name=gitolite
version=git-bd789c0
sversion=bd789c029b10d3ce10668a473838ecd339888b90
release=1
source=()

build() {
	cd $PKGMK_SOURCE_DIR
	if cd $name.git; then
		git pull --rebase git://github.com/sitaramc/$name.git master
		git checkout $sversion
	else
		git clone git://github.com/sitaramc/$name.git $name.git
		cd $name.git
		git checkout $sversion
	fi
	cp -r $PKGMK_SOURCE_DIR/$name.git $SRC

	cd $SRC/$name.git

	git describe --tags --long > conf/VERSION

	install -d $PKG/usr/bin
	install -d $PKG/etc/gitolite
	install -d $PKG/usr/share/gitolite/hooks
	install -d $PKG/usr/share/doc/gitolite
	install -t $PKG/usr/bin src/*
	install -t $PKG/etc/gitolite conf/*
	cp -r hooks/* ${PKG}/usr/share/gitolite/hooks
	cp doc/* $PKG/usr/share/doc/gitolite
}
