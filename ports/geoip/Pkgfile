# Description: A free GeoIP Country database.
# URL: http://www.maxmind.com/app/c
# Maintainer: Danny Rawlins, monster dot romster at gmail dot com
# Packager: Younes Hafri, ycrux at club-internet dot fr

name=geoip
version=1.4.4
release=1
source=(http://www.maxmind.com/download/geoip/api/c/GeoIP-$version.tar.gz \
	http://www.maxmind.com/download/geoip/database/GeoIP.dat.gz \
	geoip-$version-make-sbin.patch)

build() {
	cd GeoIP-$version

	patch -p 1 -i $SRC/geoip-$version-make-sbin.patch

	./configure \
		--prefix=/usr \
		--with-city=yes \
		--disable-static

	make -j 1
	make DESTDIR=$PKG install

	rm $PKG/usr/etc/GeoIP.conf.default
	rm $PKG/usr/share/GeoIP/GeoIP.dat # out with the old
	gzip -d ../GeoIP.dat.gz
	install -m 0644 ../GeoIP.dat $PKG/usr/share/GeoIP/ # in with the new
}

