# Description: Web proxy with advanced filtering capabilities.
# URL: http://www.privoxy.org/
# Maintainer: Danny Rawlins, romster at shortcircuit dot net dot au
# Packager: Mattias Hedenskog, mattias at hedenskog dot se
# Depends on: libpcre

name=privoxy
version=3.0.6
release=1
source=(http://dl.sourceforge.net/sourceforge/ijbswa/privoxy-$version-stable-src.tar.gz)

build() {
	cd privoxy-$version-stable
	autoheader
	autoconf

	./configure \
		--prefix=/usr \
		--enable-no-gifs

	make

	sed -i -e "s|%%SYSCONFDIR%%|/etc/|" config
	sed -i -e "s|^logdir \.|logdir /var/log/privoxy|" config
	sed -i -e "s|^confdir \.|confdir /etc/privoxy|" config
	
	install -d \
		$PKG/etc/privoxy/templates \
		$PKG/usr/share \
		$PKG/var/log/privoxy

	install -D -m755 privoxy $PKG/usr/sbin/privoxy
	install -m644 *.action config default.filter $PKG/etc/privoxy/
	install -m644 templates/* $PKG/etc/privoxy/templates/
	install -D -m644 privoxy.1 $PKG/usr/man/man1/privoxy.1
}

