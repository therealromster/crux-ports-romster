diff -pruN xorg-server-1.4.orig/dix/devices.c xorg-server-1.4/dix/devices.c
--- xorg-server-1.4.orig/dix/devices.c	2007-11-13 22:33:57.000000000 +1100
+++ xorg-server-1.4/dix/devices.c	2007-11-13 22:39:21.000000000 +1100
@@ -294,7 +294,17 @@ CoreKeyboardBell(int volume, DeviceIntPt
 static void
 CoreKeyboardCtl(DeviceIntPtr pDev, KeybdCtrl *ctrl)
 {
+#ifdef XKB
+    if (!noXkbExtension) {
+        DeviceIntPtr dev = (DeviceIntPtr)
+        pDev->devPrivates[CoreDevicePrivatesIndex].ptr;
+
+        if (dev && dev->key && dev->key->xkbInfo && dev->key->xkbInfo->kbdProc)
+            (*dev->key->xkbInfo->kbdProc)(dev, ctrl);
+    }
+#else
     return;
+#endif
 }
 
 /**
