# $Id: 
# Description:	Realtime Linux security module.
# URL:			http://sourceforge.net/projects/realtime-lsm/
# Maintainer:	Danny Rawlins, <romster@shortcircuit.net.au>
# Packager:		Danny Rawlins, <romster@shortcircuit.net.au>
# Depends on:	kernel-patch-realtime

name=module-realtime
version=0.8.7
release=1
source=(http://dl.sourceforge.net/sourceforge/realtime-lsm/realtime-lsm-$version.tar.gz)

build () {
	cd realtime-lsm-$version
	export KERNEL_DIR=/usr/src/linux-$(uname -r)
	#export KERNEL_DIR=/usr/src/linux-2.6.18
	
	# remove default
	sed -i "s|KERNEL_DIR := /usr/src/linux||" Makefile
	
	make

	# manually install as Makefile bypasses the ports system
	#make DESTDIR=$PKG install
	
	# default install dir
	#install -D -m644 realtime.ko $PKG/usr/src/$KERNEL_DIR/security/realtime.ko

	# I decided to install here instead of running make modules_install on the kernel
	install -D -m644 -oroot -groot realtime.ko $PKG/lib/modules/$(uname -r)/security/realtime.ko
}

# enable as a module Security options - Realtime Capabilites
#
# add realtime.ko to rc.modules
